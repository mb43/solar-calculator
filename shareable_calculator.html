<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Center Solar + Battery Economics Calculator</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(45deg, #3498db, #2c3e50);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .tariff-selector {
            background: #e8f4f8;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border-left: 5px solid #3498db;
        }
        
        .inputs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .input-group {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid #3498db;
        }
        
        .input-group h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        .input-row {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            font-weight: 600;
            color: #34495e;
            margin-bottom: 5px;
            font-size: 0.9em;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .calculate-btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }
        
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }
        
        .results {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
            display: none;
        }
        
        .results h2 {
            text-align: center;
            margin-bottom: 25px;
            font-size: 2em;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .result-card {
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .result-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .result-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .business-highlight {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .business-highlight h4 {
            color: #155724;
            margin-bottom: 10px;
        }
        
        .energy-breakdown {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .breakdown-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .breakdown-item {
            text-align: center;
            padding: 10px;
        }
        
        .assumptions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .assumptions h4 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .assumptions ul {
            color: #856404;
            margin: 0;
            padding-left: 20px;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            color: #7f8c8d;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè¢ Data Center Solar + Battery Economics</h1>
        
        <div class="business-highlight">
            <h4>üéØ Octopus Business Tariffs for Data Centers</h4>
            <p><strong>Shape Shifters</strong> offers significant savings for high-consumption operations. Trial results show 100% of businesses saved money, with some achieving ¬£2,000+ annual savings. Your continuous load makes this extremely compelling for operations like data centers, manufacturing, and commercial facilities.</p>
        </div>
        
        <div class="tariff-selector">
            <h3>Select Business Tariff</h3>
            <select id="tariffType" onchange="updateTariffRates()">
                <option value="trio">Shape Shifters: Trio (3 guaranteed rates, 21hrs cheaper electricity)</option>
                <option value="agile">Shape Shifters: Agile (Dynamic half-hourly pricing)</option>
                <option value="flux">Octopus Flux (Solar + Battery optimized)</option>
                <option value="residential">Residential Tariff (for comparison)</option>
            </select>
        </div>
        
        <div class="inputs-grid">
            <div class="input-group">
                <h3>‚ö° System Specifications</h3>
                <div class="input-row">
                    <label for="solarCapacity">Solar PV Capacity (kW)</label>
                    <input type="number" id="solarCapacity" value="30" step="0.1">
                </div>
                <div class="input-row">
                    <label for="batteryCapacity">Battery Storage (kWh)</label>
                    <input type="number" id="batteryCapacity" value="360" step="1">
                </div>
                <div class="input-row">
                    <label for="batteryEfficiency">Battery Efficiency (%)</label>
                    <input type="number" id="batteryEfficiency" value="90" step="1">
                </div>
                <div class="input-row">
                    <label for="continuousLoad">Continuous Load (kW)</label>
                    <input type="number" id="continuousLoad" value="120" step="1">
                </div>
                <div class="input-row">
                    <label for="loadFactor">Load Factor (%)</label>
                    <input type="number" id="loadFactor" value="95" step="1">
                </div>
            </div>
            
            <div class="input-group">
                <h3>üí∞ Financial Parameters</h3>
                <div class="input-row">
                    <label for="initialCost">Initial Infrastructure Cost (¬£)</label>
                    <input type="number" id="initialCost" value="250000" step="1000">
                </div>
                <div class="input-row">
                    <label for="analysisYears">Analysis Period (years)</label>
                    <input type="number" id="analysisYears" value="25" step="1">
                </div>
                <div class="input-row">
                    <label for="discountRate">Discount Rate (%)</label>
                    <input type="number" id="discountRate" value="3.5" step="0.1">
                </div>
                <div class="input-row">
                    <label for="inflationRate">Energy Price Inflation (%)</label>
                    <input type="number" id="inflationRate" value="2.5" step="0.1">
                </div>
                <div class="input-row">
                    <label for="carbonValue">Carbon Value (¬£/tonne CO2)</label>
                    <input type="number" id="carbonValue" value="50" step="5">
                </div>
            </div>
            
            <div class="input-group">
                <h3>‚ö° Tariff Rates (p/kWh)</h3>
                <div class="input-row">
                    <label for="nightRate">Night Rate (00:00-07:00)</label>
                    <input type="number" id="nightRate" value="8.0" step="0.1">
                </div>
                <div class="input-row">
                    <label for="dayRate">Day Rate (07:00-16:00, 19:00-00:00)</label>
                    <input type="number" id="dayRate" value="18.0" step="0.1">
                </div>
                <div class="input-row">
                    <label for="peakRate">Peak Rate (16:00-19:00)</label>
                    <input type="number" id="peakRate" value="35.0" step="0.1">
                </div>
                <div class="input-row">
                    <label for="exportRate">Export Rate (peak period)</label>
                    <input type="number" id="exportRate" value="30.0" step="0.1">
                </div>
                <div class="input-row">
                    <label for="standingCharge">Daily Standing Charge (¬£/day)</label>
                    <input type="number" id="standingCharge" value="1.20" step="0.05">
                </div>
            </div>
            
            <div class="input-group">
                <h3>üìä Performance Parameters</h3>
                <div class="input-row">
                    <label for="solarYield">Annual Solar Yield (kWh/kWp)</label>
                    <input type="number" id="solarYield" value="950" step="10">
                </div>
                <div class="input-row">
                    <label for="solarDegradation">Solar Degradation (%/year)</label>
                    <input type="number" id="solarDegradation" value="0.5" step="0.1">
                </div>
                <div class="input-row">
                    <label for="batteryDegradation">Battery Degradation (%/year)</label>
                    <input type="number" id="batteryDegradation" value="2.0" step="0.1">
                </div>
                <div class="input-row">
                    <label for="batteryStrategy">Battery Usage Strategy (%)</label>
                    <input type="number" id="batteryStrategy" value="50" step="1">
                </div>
                <div class="input-row">
                    <label for="gridCarbonFactor">Grid Carbon Factor (kg CO2/kWh)</label>
                    <input type="number" id="gridCarbonFactor" value="0.19" step="0.01">
                </div>
            </div>
        </div>
        
        <button class="calculate-btn" onclick="calculateDataCenterEconomics()">
            Calculate 25-Year Business Case üöÄ
        </button>
        
        <div id="results" class="results">
            <h2>üìà Business Case Analysis</h2>
            <div class="results-grid">
                <div class="result-card">
                    <div class="result-value" id="totalSavings">¬£0</div>
                    <div class="result-label">Total 25-Year Savings</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="annualSavings">¬£0</div>
                    <div class="result-label">Average Annual Savings</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="paybackPeriod">0</div>
                    <div class="result-label">Payback Period</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="roi">0%</div>
                    <div class="result-label">25-Year ROI</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="npv">¬£0</div>
                    <div class="result-label">Net Present Value</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="carbonSaving">0</div>
                    <div class="result-label">25-Year Carbon Saving (tonnes)</div>
                </div>
            </div>
            
            <div class="energy-breakdown">
                <h3>üîã Energy Strategy Breakdown</h3>
                <div class="breakdown-grid">
                    <div class="breakdown-item">
                        <div style="font-size: 1.5em; font-weight: bold;" id="dailyLoad">0 kWh</div>
                        <div>Daily Energy Consumption</div>
                    </div>
                    <div class="breakdown-item">
                        <div style="font-size: 1.5em; font-weight: bold;" id="dailySolar">0 kWh</div>
                        <div>Daily Solar Generation</div>
                    </div>
                    <div class="breakdown-item">
                        <div style="font-size: 1.5em; font-weight: bold;" id="batteryCycles">0 kWh</div>
                        <div>Daily Battery Cycling</div>
                    </div>
                    <div class="breakdown-item">
                        <div style="font-size: 1.5em; font-weight: bold;" id="peakReduction">0%</div>
                        <div>Peak Load Reduction</div>
                    </div>
                </div>
            </div>
            
            <div class="assumptions">
                <h4>üìã Business Case Assumptions</h4>
                <ul id="assumptionsList">
                </ul>
            </div>
        </div>
        
        <div class="footer">
            <p>Solar + Battery Economics Calculator | Based on UK Octopus Energy tariffs 2025</p>
            <p>Adjust parameters above to model different scenarios and business cases</p>
        </div>
    </div>

    <script>
        function updateTariffRates() {
            const tariffType = document.getElementById('tariffType').value;
            
            const tariffPresets = {
                trio: {
                    nightRate: 8.0,
                    dayRate: 18.0,
                    peakRate: 35.0,
                    exportRate: 30.0,
                    standingCharge: 1.20
                },
                agile: {
                    nightRate: 5.0,
                    dayRate: 15.0,
                    peakRate: 45.0,
                    exportRate: 40.0,
                    standingCharge: 1.20
                },
                flux: {
                    nightRate: 7.5,
                    dayRate: 23.0,
                    peakRate: 28.0,
                    exportRate: 28.0,
                    standingCharge: 0.60
                },
                residential: {
                    nightRate: 7.0,
                    dayRate: 24.0,
                    peakRate: 24.0,
                    exportRate: 15.0,
                    standingCharge: 0.60
                }
            };
            
            const preset = tariffPresets[tariffType];
            document.getElementById('nightRate').value = preset.nightRate;
            document.getElementById('dayRate').value = preset.dayRate;
            document.getElementById('peakRate').value = preset.peakRate;
            document.getElementById('exportRate').value = preset.exportRate;
            document.getElementById('standingCharge').value = preset.standingCharge;
        }
        
        function calculateDataCenterEconomics() {
            const inputs = {
                solarCapacity: parseFloat(document.getElementById('solarCapacity').value),
                batteryCapacity: parseFloat(document.getElementById('batteryCapacity').value),
                batteryEfficiency: parseFloat(document.getElementById('batteryEfficiency').value) / 100,
                continuousLoad: parseFloat(document.getElementById('continuousLoad').value),
                loadFactor: parseFloat(document.getElementById('loadFactor').value) / 100,
                initialCost: parseFloat(document.getElementById('initialCost').value),
                analysisYears: parseInt(document.getElementById('analysisYears').value),
                discountRate: parseFloat(document.getElementById('discountRate').value) / 100,
                inflationRate: parseFloat(document.getElementById('inflationRate').value) / 100,
                carbonValue: parseFloat(document.getElementById('carbonValue').value),
                nightRate: parseFloat(document.getElementById('nightRate').value) / 100,
                dayRate: parseFloat(document.getElementById('dayRate').value) / 100,
                peakRate: parseFloat(document.getElementById('peakRate').value) / 100,
                exportRate: parseFloat(document.getElementById('exportRate').value) / 100,
                standingCharge: parseFloat(document.getElementById('standingCharge').value),
                solarYield: parseFloat(document.getElementById('solarYield').value),
                solarDegradation: parseFloat(document.getElementById('solarDegradation').value) / 100,
                batteryDegradation: parseFloat(document.getElementById('batteryDegradation').value) / 100,
                batteryStrategy: parseFloat(document.getElementById('batteryStrategy').value) / 100,
                gridCarbonFactor: parseFloat(document.getElementById('gridCarbonFactor').value)
            };
            
            const dailyLoad = inputs.continuousLoad * 24 * inputs.loadFactor;
            const annualLoad = dailyLoad * 365;
            const annualSolarGeneration = inputs.solarCapacity * inputs.solarYield;
            const dailySolarGeneration = annualSolarGeneration / 365;
            
            const nightHours = 7;
            const dayHours = 12;
            const peakHours = 3;
            
            const nightLoad = inputs.continuousLoad * nightHours * inputs.loadFactor;
            const dayLoad = inputs.continuousLoad * dayHours * inputs.loadFactor;
            const peakLoad = inputs.continuousLoad * peakHours * inputs.loadFactor;
            
            let totalSavings = 0;
            let totalCarbonSaving = 0;
            let cumulativeSavings = 0;
            let paybackYear = null;
            
            for (let year = 1; year <= inputs.analysisYears; year++) {
                const solarPerformance = Math.pow(1 - inputs.solarDegradation, year - 1);
                const batteryPerformance = Math.pow(1 - inputs.batteryDegradation, year - 1);
                
                const yearSolarGeneration = annualSolarGeneration * solarPerformance;
                const yearDailySolar = yearSolarGeneration / 365;
                
                const effectiveBatteryCapacity = inputs.batteryCapacity * batteryPerformance;
                
                const maxBatteryUsage = effectiveBatteryCapacity * inputs.batteryStrategy;
                const peakLoadReduction = Math.min(peakLoad, maxBatteryUsage);
                
                const directSolarUse = Math.min(yearDailySolar, dailyLoad * 0.7);
                const excessSolar = Math.max(0, yearDailySolar - directSolarUse);
                
                const baselineCost = (
                    nightLoad * inputs.nightRate +
                    dayLoad * inputs.dayRate +
                    peakLoad * inputs.peakRate +
                    inputs.standingCharge
                ) * 365;
                
                const nightCharging = peakLoadReduction;
                const adjustedNightLoad = nightLoad + nightCharging;
                const adjustedPeakLoad = peakLoad - peakLoadReduction;
                const adjustedDayLoad = dayLoad - directSolarUse;
                
                const optimizedCost = (
                    adjustedNightLoad * inputs.nightRate +
                    Math.max(0, adjustedDayLoad) * inputs.dayRate +
                    adjustedPeakLoad * inputs.peakRate +
                    inputs.standingCharge
                ) * 365;
                
                const peakExport = Math.min(excessSolar, inputs.solarCapacity * 2);
                const exportEarnings = peakExport * inputs.exportRate * 365;
                
                const carbonSaving = (directSolarUse + peakLoadReduction) * 365 * inputs.gridCarbonFactor / 1000;
                const carbonValue = carbonSaving * inputs.carbonValue;
                
                const inflationFactor = Math.pow(1 + inputs.inflationRate, year - 1);
                const annualSavings = (baselineCost - optimizedCost + exportEarnings + carbonValue) * inflationFactor;
                
                const discountFactor = Math.pow(1 + inputs.discountRate, year);
                const presentValue = annualSavings / discountFactor;
                
                totalSavings += presentValue;
                totalCarbonSaving += carbonSaving;
                cumulativeSavings += annualSavings;
                
                if (!paybackYear && cumulativeSavings >= inputs.initialCost) {
                    paybackYear = year + (inputs.initialCost - (cumulativeSavings - annualSavings)) / annualSavings;
                }
            }
            
            const netPresentValue = totalSavings - inputs.initialCost;
            const averageAnnualSavings = totalSavings / inputs.analysisYears;
            const roi = (totalSavings / inputs.initialCost - 1) * 100;
            const peakReductionPercent = (Math.min(peakLoad, inputs.batteryCapacity * inputs.batteryStrategy) / peakLoad) * 100;
            
            document.getElementById('totalSavings').textContent = '¬£' + Math.round(totalSavings).toLocaleString();
            document.getElementById('annualSavings').textContent = '¬£' + Math.round(averageAnnualSavings).toLocaleString();
            document.getElementById('paybackPeriod').textContent = paybackYear ? paybackYear.toFixed(1) + ' years' : '> ' + inputs.analysisYears + ' years';
            document.getElementById('roi').textContent = roi.toFixed(1) + '%';
            document.getElementById('npv').textContent = '¬£' + Math.round(netPresentValue).toLocaleString();
            document.getElementById('carbonSaving').textContent = Math.round(totalCarbonSaving).toLocaleString();
            
            document.getElementById('dailyLoad').textContent = Math.round(dailyLoad).toLocaleString() + ' kWh';
            document.getElementById('dailySolar').textContent = Math.round(dailySolarGeneration).toLocaleString() + ' kWh';
            document.getElementById('batteryCycles').textContent = Math.round(inputs.batteryCapacity * inputs.batteryStrategy).toLocaleString() + ' kWh';
            document.getElementById('peakReduction').textContent = peakReductionPercent.toFixed(1) + '%';
            
            const tariffType = document.getElementById('tariffType').value;
            const tariffNames = {
                trio: 'Shape Shifters: Trio',
                agile: 'Shape Shifters: Agile',
                flux: 'Octopus Flux',
                residential: 'Residential Tariff'
            };
            
            document.getElementById('assumptionsList').innerHTML = `
                <li>Tariff: ${tariffNames[tariffType]} with optimized load shifting strategy</li>
                <li>Facility runs 24/7 at ${(inputs.loadFactor * 100).toFixed(0)}% load factor (${Math.round(dailyLoad).toLocaleString()} kWh/day)</li>
                <li>Battery cycles ${(inputs.batteryStrategy * 100).toFixed(0)}% of capacity daily for peak shaving</li>
                <li>Peak load reduction: ${peakReductionPercent.toFixed(1)}% during 16:00-19:00 window</li>
                <li>Solar self-consumption: ${Math.round((directSolarUse/dailyLoad)*100)}% of daily generation</li>
                <li>Energy prices inflate at ${(inputs.inflationRate * 100).toFixed(1)}% annually</li>
                <li>Carbon value: ¬£${inputs.carbonValue}/tonne CO2 (${Math.round(totalCarbonSaving).toLocaleString()} tonnes saved)</li>
                <li>System degradation: Solar ${(inputs.solarDegradation * 100).toFixed(1)}%/year, Battery ${(inputs.batteryDegradation * 100).toFixed(1)}%/year</li>
            `;
            
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }
        
        updateTariffRates();
    </script>
</body>
</html>